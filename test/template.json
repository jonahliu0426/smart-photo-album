{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Parameters": {
        "ArtifactStoreLocation": {
            "Type": "String",
            "Default": "codepipeline-us-east-1-370481666524"
        },
        "GitHubOwner": {
            "Type": "String",
            "Default": "ly2062"
        },
        "GitHubRepo": {
            "Type": "String",
            "Default": "aws-test"
        },
        "GitHubOAuthToken": {
            "Type": "String",
            "Default": "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"
        },
        "BuildSourceLocation": {
            "Type": "String",
            "Default": "https://github.com/ly2062/aws-test"
        }
    },
    "Resources": {
        "CodePipeline1": {
            "Type" : "AWS::CodePipeline::Pipeline",
            "Properties" : {
                "ArtifactStore" : {
                    "Type": "S3",
                    "Location": { "Ref" : "ArtifactStoreLocation" }
                },
                "Name" : "CodePipeline0x0",
                "RoleArn" : "arn:aws:iam::149455699905:role/service-role/AWSCodePipelineServiceRole-us-east-1-test-491",
                "Stages" : [
                    {
                        "Name": "Source",
                        "Actions": [
                            {
                                "Name": "Source",
                                "ActionTypeId": {
                                    "Category": "Source",
                                    "Owner": "ThirdParty",
                                    "Provider": "GitHub",
                                    "Version": "1"
                                },
                                "RunOrder": 1,
                                "Configuration": {
                                    "Branch": "main",
                                    "OAuthToken": { "Ref" : "GitHubOAuthToken" },
                                    "Owner": { "Ref" : "GitHubOwner" },
                                    "PollForSourceChanges": "true",
                                    "Repo": { "Ref" : "GitHubRepo" }
                                },
                                "OutputArtifacts": [
                                    {
                                        "Name": "SourceArtifact"
                                    }
                                ],
                                "InputArtifacts": [],
                                "Region": "us-east-1",
                                "Namespace": "SourceVariables"
                            }
                        ]
                    },
                    {
                        "Name": "Build",
                        "Actions": [
                            {
                                "Name": "Build",
                                "ActionTypeId": {
                                    "Category": "Build",
                                    "Owner": "AWS",
                                    "Provider": "CodeBuild",
                                    "Version": "1"
                                },
                                "RunOrder": 1,
                                "Configuration": {
                                    "ProjectName": "CodeBuild0x0"
                                },
                                "OutputArtifacts": [
                                    {
                                        "Name": "BuildArtifact"
                                    }
                                ],
                                "InputArtifacts": [
                                    {
                                        "Name": "SourceArtifact"
                                    }
                                ],
                                "Region": "us-east-1",
                                "Namespace": "BuildVariables"
                            }
                        ]
                    }
                ]
            },
            "DependsOn": "CodeBuild1"
        },
        "CodeBuild1": {
            "Type" : "AWS::CodeBuild::Project",
            "Properties" : {
                "Artifacts" : {
                    "Type": "NO_ARTIFACTS"
                },
                "BadgeEnabled" : false,
                "Cache" : {
                    "Type": "NO_CACHE"
                },
                "EncryptionKey" : "arn:aws:kms:us-east-1:149455699905:alias/aws/s3",
                "Environment" : {
                    "Type": "LINUX_CONTAINER",
                    "Image": "aws/codebuild/standard:5.0",
                    "ComputeType": "BUILD_GENERAL1_SMALL",
                    "EnvironmentVariables": [],
                    "PrivilegedMode": false,
                    "ImagePullCredentialsType": "CODEBUILD"
                },
                "LogsConfig" : {
                    "CloudWatchLogs": {
                        "Status": "DISABLED"
                    },
                    "S3Logs": {
                        "Status": "DISABLED",
                        "EncryptionDisabled": false
                    }
                },
                "Name" : "CodeBuild0x0",
                "QueuedTimeoutInMinutes" : 480,
                "SecondaryArtifacts" : [],
                "SecondarySources" : [],
                "SecondarySourceVersions" : [],
                "ServiceRole" : "arn:aws:iam::149455699905:role/service-role/codebuild-github-to-lambda-service-role",
                "Source" : {
                    "Type": "GITHUB",
                    "Location": { "Ref" : "BuildSourceLocation" },
                    "GitCloneDepth": 1,
                    "GitSubmodulesConfig": {
                        "FetchSubmodules": false
                    },
                    "InsecureSsl": false
                },
                "Tags" : [],
                "TimeoutInMinutes" : 60
            }
        }
    }
}